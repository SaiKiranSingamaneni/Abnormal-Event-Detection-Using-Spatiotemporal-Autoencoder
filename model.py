from keras.layers import Conv3D, ConvLSTM2D, Conv3DTranspose
from keras.models import Sequential

'''Creates model with specified layers, compiles it and returns the model'''


def load_model():
    model = Sequential()
    model.add(Conv3D(filters=128, kernel_size=(11, 11, 1), strides=(
        4, 4, 1), padding='valid', input_shape=(227, 227, 10, 1), activation='tanh'))
    model.add(Conv3D(filters=64, kernel_size=(5, 5, 1), strides=(
        2, 2, 1), padding='valid', activation='tanh'))

    model.add(ConvLSTM2D(filters=64, kernel_size=(3, 3), strides=1,
              padding='same', dropout=0.4, recurrent_dropout=0.3, return_sequences=True))

    model.add(ConvLSTM2D(filters=32, kernel_size=(3, 3), strides=1,
              padding='same', dropout=0.3, return_sequences=True))

    model.add(ConvLSTM2D(filters=64, kernel_size=(3, 3), strides=1,
              return_sequences=True, padding='same', dropout=0.5))

    model.add(Conv3DTranspose(filters=128, kernel_size=(5, 5, 1),
              strides=(2, 2, 1), padding='valid', activation='tanh'))
    model.add(Conv3DTranspose(filters=1, kernel_size=(11, 11, 1),
              strides=(4, 4, 1), padding='valid', activation='tanh'))

    model.compile(optimizer='adam', loss='mean_squared_error',
                  metrics=['accuracy'])
    print("Model Created")

    return model
